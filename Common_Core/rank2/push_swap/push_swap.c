// TODO: Main function and auxiliary functions